<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="bess.ham.infra.modules.product.ProductMapper">

    <resultMap id="resultMapObj" type="bess.ham.infra.modules.product.Product"></resultMap>
    
    
	
	<select id="selectListMain" resultMap="resultMapObj"> 
		SELECT 
			pro.seq as ifpoSeq
			,pr.category as ifprCategory
			,pr.title as ifprTitle
			,pro.option as ifpoOption
			,pro.optionSub as ifpoOptionSub
			,pr.price as ifprPrice
			,pr.stock as ifprStock
			,pr.mainYn as ifprMainYn
		FROM product pr
		LEFT JOIN productOption pro ON pr.seq = pro.product_seq
		WHERE 1=1
		AND mainYN = 1
		<if test="ifprCategory != null and !ifprCategory.equals('')">AND pr.category = #{ifprCategory}</if>
		;
	</select>
	
	<insert id="insert">
		INSERT INTO product(
	    	category
	    	,title
	    	,price
	    	,stock
		)
		
		VALUES (
			#{category}
			,#{title}
			,#{price}
			,#{stock}
		)
		<selectKey resultType="String" keyProperty="seq" order="AFTER">
		SELECT last_insert_id()
		</selectKey>
	
	</insert>
	
<!-- 	<select id="selectListMain" resultMap="resultMapObj"> 
		SELECT 
			pr.seq AS ifprSeq
			pr.title AS ifprTitle 
			pr.price AS ifprPrice
		FROM product pr
		WHERE 1=1
		AND mainYN = 1;
	</select> -->
	

</mapper>	



